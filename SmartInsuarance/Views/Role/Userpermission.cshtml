@using SmartInsuarance.Models
@model List<UserPagingPermission>
@{
    ViewBag.Title = "Userpermission";
    Layout = "~/Views/Shared/_Layout_new.cshtml";
    int mappingid = (int)ViewBag.mapping;
}
<style>
    .Paddingtop1 {
        padding-top: 10px !important;
        padding-bottom: 10px !important
    }

    .top:hover, .top:active {
        background-color: red;
    }
</style>
<link href="~/Content/Custom.css" rel="stylesheet" />
<div class="col-lg-12">
    <div class="card">
        <div class="card-header">
            <h4 class="card-title" style="color: blanchedalmond;font-weight: bold;">Role Permission</h4>
            <a href="@Url.Action("RoleMappingDepartmentandGroupIndex", "Role")" class="btn btn-default top" style="color: antiquewhite;">Back</a>

        </div>
        <div class="card-body">
            <div class="table-responsive">
                <table class="table table-responsive-md" id="tblCustomers">
                    <thead>
                        <tr>

                            <th>#No</th>

                            <th>Menu Name</th>
                            <th>SubMenu Name</th>
                            <th>Insert</th>
                            <th>Update</th>
                            <th>Delete</th>
                            <th>View</th>
                            <th>Active</th>
                            @*<th>Action</th>*@
                        </tr>
                    <tbody id="tbody">
                        @{
                            var i = 1;
                            foreach (var item in Model)
                            {
                                <tr id="tr_@item.ID">
                                    <td>@i</td>
                                    <td>
                                        @item.MenuName
                                    </td>
                                    <td>
                                        @item.SubMenuName
                                    </td>

                                    <td>
                                        <div class="form-check form-switch">
                                            @{if (item.perInsert == 1)
                                                {
                                                    <input id="InsertOperation-@item.ID-@item.UserID" class="form-check-input InsertStatus" type="checkbox" data-id="InsertOperation-@item.ID-@item.UserID" name="@item.ID-@item.UserID" value="@item.perInsert" checked>
                                                }
                                                else
                                                {
                                                    <input id="InsertOperation-@item.ID-@item.UserID" class="form-check-input InsertStatus" type="checkbox" data-id="InsertOperation-@item.ID-@item.UserID" name="@item.ID-@item.UserID" value="@item.perInsert">

                                                }
                                            }

                                        </div>




                                    </td>
                                    <td>
                                        <div class="form-check form-switch">
                                            @{if (item.perEdit == 1)
                                                {
                                                    <input id="UpdateOpertaion-@item.ID-@item.UserID" class="form-check-input InsertStatus" type="checkbox" data-id="UpdateOpertaion-@item.ID-@item.UserID" name="@item.ID-@item.UserID" value="@item.perEdit" checked>
                                                }
                                                else
                                                {
                                                    <input id="UpdateOpertaion-@item.ID-@item.UserID" class="form-check-input InsertStatus" type="checkbox" data-id="UpdateOpertaion-@item.ID-@item.UserID" name="@item.ID-@item.UserID" value="@item.perEdit">

                                                }
                                            }

                                        </div>




                                    </td>
                                    <td>
                                        <div class="form-check form-switch">
                                            @{if (item.perDelete == 1)
                                                {
                                                    <input id="DeleteOperation-@item.ID-@item.UserID" class="form-check-input InsertStatus" type="checkbox" data-id="DeleteOperation-@item.ID-@item.UserID" name="@item.ID-@item.UserID" value="@item.perDelete" checked>
                                                }
                                                else
                                                {
                                                    <input id="DeleteOperation-@item.ID-@item.UserID" class="form-check-input InsertStatus" type="checkbox" data-id="DeleteOperation-@item.ID-@item.UserID" name="@item.ID-@item.UserID" value="@item.perDelete">

                                                }
                                            }

                                        </div>




                                    </td>
                                    <td>
                                        <div class="form-check form-switch">
                                            @{if (item.perView == 1)
                                                {
                                                    <input id="ViewOperation-@item.ID-@item.UserID" class="form-check-input InsertStatus" type="checkbox" data-id="ViewOperation-@item.ID-@item.UserID" name="@item.ID-@item.UserID" value="@item.perView" checked>
                                                }
                                                else
                                                {
                                                    <input id="ViewOperation-@item.ID-@item.UserID" class="form-check-input InsertStatus" type="checkbox" data-id="ViewOperation-@item.ID-@item.UserID" name="@item.ID-@item.UserID" value="@item.perView">

                                                }
                                            }

                                        </div>




                                    </td>
                                    <td>
                                        <div class="form-check form-switch">
                                            @{if (item.perStatus == 1)
                                                {
                                                    <input id="Status-@item.ID-@item.UserID" class="form-check-input InsertStatus" type="checkbox" data-id="Status-@item.ID-@item.UserID" name="@item.ID-@item.UserID" value="@item.perStatus" checked>
                                                }
                                                else
                                                {
                                                    <input id="Status-@item.ID-@item.UserID" class="form-check-input InsertStatus" type="checkbox" data-id="Status-@item.ID-@item.UserID" name="@item.ID-@item.UserID" value="@item.perStatus">

                                                }
                                            }

                                        </div>




                                    </td>
                                    @*<td>

                                            @{




                                                <a id="btnDeactive_@item.MenuMappingwithSubmenuId" class="Deleteclass" name="2" data-id="@item.MenuMappingwithSubmenuId" onclick="DeleteData(@item.MenuMappingwithSubmenuId)" title="Delete"><i class="fas fa-times text-danger font-16"></i></a>


                                            }

                                        </td>*@
                                </tr>
                                i++;
                            }
                        }


                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script src="~/Content/globalDomain.js"></script>
<script src="~/Content/Template/js/jScript.js"></script>

<script type="text/javascript">
        $(".InsertStatus").change(function () {
            debugger
            var id = $(this).data("id");
            var item = id.split('-');
            var type = parseInt($(this).val())==1?0:1;
            let msgstring;
            if (item[0] == 'InsertOperation') {
                msgstring = 'Insert';
            }
            if (item[0] == 'UpdateOpertaion') {
                msgstring = 'Update';
            }
            if (item[0] == 'InsertOperation') {
                msgstring = 'InsertOperation';
            }
            if (item[0] == 'DeleteOperation') {
                msgstring = 'Delete';
            }
            if (item[0] == 'ViewOperation') {
                msgstring = 'View';
            }
            if (item[0] == 'Status') {
                msgstring = 'Status';
            }
            //else {
            //    type = 0;
            //}
            var Params = JSON.stringify(
                {
                    Typedata: item[0],
                    MappingId: @mappingid,
                    PermissionId: item[2],
                    MstGroupId: item[1],
                    status: type
                });

            $.ajax({
                url: GetglobalDomain() + "/Role/OperationStatus",//GetglobalDomain() +
                type: 'POST',
                dataType: "json",
                contentType: "application/json",
                data: Params,
                success: function (response) {
                    debugger;
                    if (response.isvalid == 1) {

                        var msg = msgstring +' '+'Changes Successfully';
                        if (type == 0) {
                            $("#" + id).val(0);
                            /* $(this).val('0');*/
                            msg = msgstring + ' ' +'De-Active Successfully';
                        }
                        else {
                            $("#" + id).val(1);
                            /* $(this).val('1');*/
                            msg = msgstring + ' ' +'Active Successfully';
                        }
                        Swal.fire({
                            position: 'center',
                            icon: 'success',
                            title: msg,
                            showConfirmButton: false,
                            timer: 3000
                        })
                    }
                }
            });

        });
</script>